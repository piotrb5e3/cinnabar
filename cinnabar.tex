\batchmode

\documentclass[a4paper,11pt]{article}
\author{Piotr Bakalarski}
\title{The Language Cinnabar}
\setlength{\parindent}{0mm}
\setlength{\parskip}{1mm}

\usepackage{minted}

\begin{document}

\maketitle

\newcommand{\emptyP}{\mbox{$\epsilon$}}
\newcommand{\terminal}[1]{\mbox{{\texttt {#1}}}}
\newcommand{\nonterminal}[1]{\mbox{$\langle \mbox{{\sl #1 }} \! \rangle$}}
\newcommand{\arrow}{\mbox{::=}}
\newcommand{\delimit}{\mbox{$|$}}
\newcommand{\reserved}[1]{\mbox{{\texttt {#1}}}}
\newcommand{\literal}[1]{\mbox{{\texttt {#1}}}}
\newcommand{\symb}[1]{\mbox{{\texttt {#1}}}}

\section*{Language features}

Cinnabar is an object-oriented, imperative programming language drawing inspiration from C, Python and JavaScript. 

\subsection*{Types}

Cinnabar is a dynamically-typed language. Built-in types are:
\begin{itemize}
\item \emph{char} -- Unicode characters,
\item \emph{bool} -- either \emph{true} or \emph{false},
\item \emph{int} -- arbitrary precision integer,
\item \emph{list} -- fixed length, mutable list with mixed type elements,
\item \emph{dictionary} -- mutable, mixed type dictionary,
\item \emph{object} -- mutable object with fields and methods,
\item \emph{function} -- anonymous function with side effects.
\end{itemize} 

\subsection*{Statements}
Cinnabar has loops, conditional expressions, assignment with list unpacking, runtime assertions. It also supports writing to standard output via the {\tt print} statement.

\subsection*{Expressions}

Cinnabar supports arithmetic, boolean and lambda expressions, python-style \emph{if-then-else}, list and dictionary literals, list comprehension and inheritance expressions.

\subsection*{Functions}

There are no named functions in Cinnabar -- only lambdas.
Calls with missing or excess parameters are considered errors.

\subsection*{Objects}

Cinnabar uses prototype inheritance: {\tt new} operator creates a shallow copy and calls the {\tt init} method with given parameters; {\tt extend with} operator creates a shallow copy, then adds or replaces fields and methods with data from a provided dictionary.


\section*{The lexical structure of cinnabar}
\subsection*{Identifiers}
Identifiers \nonterminal{Ident} are unquoted strings beginning with a letter,
followed by any combination of letters, digits, and the characters {\tt \_ '},
reserved words excluded.


\subsection*{Literals}

Integer literals \nonterminal{Integer} are sequences of decimal digits.\\
String literals \nonterminal{String} are sequences of Unicode surrounded with double quotes.\\
Character literals \nonterminal{Char} are single Unicode symbols surrounded with single quotes.





\subsection*{Reserved words and symbols}

The reserved words used in cinnabar are the following: \\

\begin{tabular}{lll}
{\reserved{assert}} &{\reserved{else}} &{\reserved{extend}} \\
{\reserved{false}} &{\reserved{for}} &{\reserved{fun}} \\
{\reserved{if}} &{\reserved{in}} &{\reserved{lambda}} \\
{\reserved{new}} &{\reserved{print}} &{\reserved{return}} \\
{\reserved{true}} &{\reserved{while}} &{\reserved{with}} \\
\end{tabular}\\

The symbols used in cinnabar are the following: \\

\begin{tabular}{lll}
{\symb{\{}} &{\symb{\}}} &{\symb{(}} \\
{\symb{)}} &{\symb{{$=$}}} &{\symb{;}} \\
{\symb{,}} &{\symb{[}} &{\symb{]}} \\
{\symb{.}} &{\symb{:}} &{\symb{{$|$}{$|$}}} \\
{\symb{\&\&}} &{\symb{{\textasciicircum}}} &{\symb{!}} \\
{\symb{{$-$}}} &{\symb{\#\{}} &{\symb{{$<$}}} \\
{\symb{{$<$}{$=$}}} &{\symb{{$>$}}} &{\symb{{$>$}{$=$}}} \\
{\symb{{$=$}{$=$}}} &{\symb{!{$=$}}} &{\symb{{$+$}}} \\
{\symb{*}} &{\symb{/}} &{\symb{\%}} \\
\end{tabular}\\

\subsection*{Comments}
Single-line comments begin with {\symb{//}}. \\Multiple-line comments are  enclosed with {\symb{/*}} and {\symb{*/}}.

\section*{The syntactic structure of cinnabar}
Non-terminals are enclosed between $\langle$ and $\rangle$. 
The symbols  {\arrow}  (production),  {\delimit}  (union) 
and {\emptyP} (empty rule) belong to the BNF notation. 
All other symbols are terminals.\\

\begin{tabular}{lll}
{\nonterminal{Program}} & {\arrow}  &{\nonterminal{ListStmt}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Block}} & {\arrow}  &{\terminal{\{}} {\nonterminal{ListStmt}} {\terminal{\}}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{ListStmt}} & {\arrow}  &{\emptyP} \\
 & {\delimit}  &{\nonterminal{Stmt}} {\nonterminal{ListStmt}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Stmt}} & {\arrow}  &{\terminal{while}} {\terminal{(}} {\nonterminal{Expr}} {\terminal{)}} {\nonterminal{Block}}  \\
 & {\delimit}  &{\terminal{if}} {\terminal{(}} {\nonterminal{Expr}} {\terminal{)}} {\nonterminal{Block}}  \\
 & {\delimit}  &{\terminal{if}} {\terminal{(}} {\nonterminal{Expr}} {\terminal{)}} {\nonterminal{Block}} {\terminal{else}} {\nonterminal{Block}}  \\
 & {\delimit}  &{\nonterminal{LVal}} {\terminal{{$=$}}} {\nonterminal{Expr}} {\terminal{;}}  \\
 & {\delimit}  &{\terminal{return}} {\nonterminal{Expr}} {\terminal{;}}  \\
 & {\delimit}  &{\terminal{print}} {\nonterminal{Expr}} {\terminal{;}}  \\
 & {\delimit}  &{\terminal{assert}} {\nonterminal{Expr}} {\terminal{;}}  \\
 & {\delimit}  &{\nonterminal{Expr}} {\terminal{;}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{LVal}} & {\arrow}  &{\nonterminal{LVal1}}  \\
 & {\delimit}  &{\terminal{\{}} {\nonterminal{ListLVal1}} {\terminal{\}}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{ListLVal1}} & {\arrow}  &{\nonterminal{LVal1}}  \\
 & {\delimit}  &{\nonterminal{LVal1}} {\terminal{,}} {\nonterminal{ListLVal1}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{LVal1}} & {\arrow}  &{\nonterminal{Expr8}} {\terminal{[}} {\nonterminal{Expr}} {\terminal{]}}  \\
 & {\delimit}  &{\nonterminal{Expr8}} {\terminal{.}} {\nonterminal{Ident}}  \\
 & {\delimit}  &{\nonterminal{Ident}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Expr}} & {\arrow}  &{\terminal{lambda}} {\nonterminal{ListIdent}} {\terminal{:}} {\nonterminal{Expr}}  \\
 & {\delimit}  &{\terminal{fun}} {\terminal{(}} {\nonterminal{ListIdent}} {\terminal{)}} {\nonterminal{Block}}  \\
 & {\delimit}  &{\nonterminal{Expr1}} {\terminal{if}} {\nonterminal{Expr}} {\terminal{else}} {\nonterminal{Expr}}  \\
 & {\delimit}  &{\nonterminal{Expr1}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{ListIdent}} & {\arrow}  &{\emptyP} \\
 & {\delimit}  &{\nonterminal{Ident}}  \\
 & {\delimit}  &{\nonterminal{Ident}} {\terminal{,}} {\nonterminal{ListIdent}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Expr1}} & {\arrow}  &{\nonterminal{Expr2}} {\terminal{{$|$}{$|$}}} {\nonterminal{Expr1}}  \\
 & {\delimit}  &{\nonterminal{Expr2}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Expr2}} & {\arrow}  &{\nonterminal{Expr3}} {\terminal{\&\&}} {\nonterminal{Expr2}}  \\
 & {\delimit}  &{\nonterminal{Expr3}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Expr3}} & {\arrow}  &{\nonterminal{Expr4}} {\nonterminal{RelOp}} {\nonterminal{Expr3}}  \\
 & {\delimit}  &{\nonterminal{Expr4}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Expr4}} & {\arrow}  &{\nonterminal{Expr5}} {\nonterminal{AddOp}} {\nonterminal{Expr4}}  \\
 & {\delimit}  &{\nonterminal{Expr5}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Expr5}} & {\arrow}  &{\nonterminal{Expr6}} {\nonterminal{MulOp}} {\nonterminal{Expr5}}  \\
 & {\delimit}  &{\nonterminal{Expr6}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Expr6}} & {\arrow}  &{\nonterminal{Expr7}} {\terminal{{\textasciicircum}}} {\nonterminal{Expr6}}  \\
 & {\delimit}  &{\nonterminal{Expr7}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Expr7}} & {\arrow}  &{\terminal{!}} {\nonterminal{Expr7}}  \\
 & {\delimit}  &{\terminal{{$-$}}} {\nonterminal{Expr7}}  \\
 & {\delimit}  &{\nonterminal{Expr8}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Expr8}} & {\arrow}  &{\nonterminal{Expr8}} {\terminal{(}} {\nonterminal{ListExpr}} {\terminal{)}}  \\
 & {\delimit}  &{\nonterminal{Expr8}} {\terminal{.}} {\nonterminal{Ident}}  \\
 & {\delimit}  &{\nonterminal{Expr8}} {\terminal{[}} {\nonterminal{Expr}} {\terminal{]}}  \\
 & {\delimit}  &{\nonterminal{Expr9}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Expr9}} & {\arrow}  &{\terminal{extend}} {\nonterminal{Expr}} {\terminal{with}} {\nonterminal{Expr9}}  \\
 & {\delimit}  &{\terminal{new}} {\nonterminal{Expr9}} {\terminal{(}} {\nonterminal{ListExpr}} {\terminal{)}}  \\
 & {\delimit}  &{\nonterminal{Expr10}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{Expr10}} & {\arrow}  &{\nonterminal{Char}}  \\
 & {\delimit}  &{\nonterminal{String}}  \\
 & {\delimit}  &{\nonterminal{Integer}}  \\
 & {\delimit}  &{\terminal{true}}  \\
 & {\delimit}  &{\terminal{false}}  \\
 & {\delimit}  &{\nonterminal{Ident}}  \\
 & {\delimit}  &{\terminal{[}} {\nonterminal{ListExpr}} {\terminal{]}}  \\
 & {\delimit}  &{\terminal{[}} {\nonterminal{Expr}} {\terminal{for}} {\nonterminal{LVal}} {\terminal{in}} {\nonterminal{Expr}} {\terminal{]}}  \\
 & {\delimit}  &{\terminal{\#\{}} {\nonterminal{ListDictMap}} {\terminal{\}}}  \\
 & {\delimit}  &{\terminal{(}} {\nonterminal{Expr}} {\terminal{)}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{ListExpr}} & {\arrow}  &{\emptyP} \\
 & {\delimit}  &{\nonterminal{Expr}}  \\
 & {\delimit}  &{\nonterminal{Expr}} {\terminal{,}} {\nonterminal{ListExpr}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{DictMap}} & {\arrow}  &{\nonterminal{Expr}} {\terminal{:}} {\nonterminal{Expr}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{ListDictMap}} & {\arrow}  &{\emptyP} \\
 & {\delimit}  &{\nonterminal{DictMap}}  \\
 & {\delimit}  &{\nonterminal{DictMap}} {\terminal{,}} {\nonterminal{ListDictMap}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{RelOp}} & {\arrow}  &{\terminal{{$<$}}}  \\
 & {\delimit}  &{\terminal{{$<$}{$=$}}}  \\
 & {\delimit}  &{\terminal{{$>$}}}  \\
 & {\delimit}  &{\terminal{{$>$}{$=$}}}  \\
 & {\delimit}  &{\terminal{{$=$}{$=$}}}  \\
 & {\delimit}  &{\terminal{!{$=$}}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{AddOp}} & {\arrow}  &{\terminal{{$+$}}}  \\
 & {\delimit}  &{\terminal{{$-$}}}  \\
\end{tabular}\\

\begin{tabular}{lll}
{\nonterminal{MulOp}} & {\arrow}  &{\terminal{*}}  \\
 & {\delimit}  &{\terminal{/}}  \\
 & {\delimit}  &{\terminal{\%}}  \\
\end{tabular}\\

\section*{Example programs}

\inputminted{js}{good/simple.cb}

\end{document}

